<ng-container *tuiLet="$builder | async as builder">
    <div *ngIf="columns.length != 0">
        <div class="grid-wrapper">
            <mat-table matSort [dataSource]="dataSource" cdkDropListGroup="" [trackBy]="trackByFn">
                <ng-container *ngFor="let column of columns; trackBy: trackByFn; let i = index"
                    [matColumnDef]="column.field">
                    <ng-container *ngIf="!!column.show">
                        <mat-header-cell class="thead" *matHeaderCellDef="" [class.resizable]="resizable"
                            [style.width]="column.actualWidth + '%'">
                            <div class="cell-header" *ngIf="column.field === 'plusAction'">
                                <mat-icon [matMenuTriggerFor]="addHideColumns">add</mat-icon>
                            </div>
                            <div class="input-name">
                                <div class="cell-header" *ngIf="column.field !== 'plusAction'" mat-sort-header>
                                    <span>{{
                                        column.name }}</span>
                                </div>
                            </div>
                            <div class="handler" (mousedown)="onResizeColumn($event, i)"></div>
                        </mat-header-cell>
                    </ng-container>
                    <ng-container>
                        <mat-cell class="tbody" *matCellDef="let row" [style.width]="column.actualWidth + '%'">
                            <ng-template *ngTemplateOutlet="cellTemplateRef; context:{row: row, column: column}"
                                [ngIf]="cellTemplateRef"></ng-template>
                            <ng-container *ngIf="!cellTemplateRef">
                                <input class="table_input" type="text" 
                                value="{{ row[column.field] }}"
                                (change)="sendChanges($event.target.value, row, column.field)"
                                >
                            </ng-container>
                        </mat-cell>
                    </ng-container>
                </ng-container>
                <mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></mat-header-row>
                <mat-row *matRowDef="let row; columns: displayedColumns;" #MatTableRowRef></mat-row>
            </mat-table>
        </div>
    </div>
</ng-container>